{"openapi":"3.0.1","info":{"title":"Bank Cards API","description":"API for managing bank cards","version":"1.0"},"servers":[{"url":"http://localhost:8080","description":"Generated server url"}],"security":[{"bearerAuth":[]}],"tags":[{"name":"Users","description":"User management operations"},{"name":"Cards","description":"Card management operations"},{"name":"Login","description":"Authentication management"}],"paths":{"/auth/login":{"post":{"tags":["Login"],"summary":"User login","description":"Authenticates a user with username and password and returns a JWT token","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthRequest"}}},"required":true},"responses":{"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"type":"string","example":{"error":"Bad credentials"}}}}},"200":{"description":"OK","content":{"application/json":{"schema":{"type":"string","example":{"token":"<jwt_token>"}}}}}}}},"/api/users":{"get":{"tags":["Users"],"summary":"Get all users","description":"List of all users","operationId":"getAllUsers","responses":{"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}},"200":{"description":"OK","content":{"application/json":{"example":[{"id":1,"username":"admin","password":"<admin_encrypted_password>","roles":["ADMIN"],"cards":[]},{"id":2,"username":"user","password":"<user_encrypted_password>","roles":["USER"],"cards":[{"id":2,"number":"**** **** **** 5013","holderName":"user","expirationDate":"2030-06-22","status":"BLOCKED","balance":42000.0},{"id":4,"number":"**** **** **** 3201","holderName":"user","expirationDate":"2030-06-23","status":"ACTIVE","balance":37000.0}]}]}}}},"security":[{"bearerAuth":[]}]},"post":{"tags":["Users"],"summary":"Create user","description":"Create new user","operationId":"createUser","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDto"},"example":{"username":"<username>","password":"<password>","roles":["USER"]}}},"required":true},"responses":{"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}},"201":{"description":"Created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDto"}}}},"409":{"description":"Conflict","content":{"application/json":{"schema":{"type":"string","example":{"message":"Username 'username' already exists"}}}}}},"security":[{"bearerAuth":[]}]}},"/api/cards/user/{id}":{"post":{"tags":["Cards"],"summary":"Create card","description":"Create card for user","operationId":"create","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"201":{"description":"Created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CardDto"}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"type":"string","example":{"message":"User with ID 10 not found"}}}}}},"security":[{"bearerAuth":[]}]}},"/api/cards/transfer":{"post":{"tags":["Cards"],"summary":"Transfer funds","description":"Transfer funds between own cards","operationId":"transfer","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransferDto"}}},"required":true},"responses":{"404":{"description":"Not Found","content":{"application/json":{"schema":{"type":"string","example":{"message":"Card with ID: 10 not found"}}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"error":"You can transfer only between your own cards."}}}}},"200":{"description":"OK","content":{"application/json":{"schema":{"type":"string","example":{"message":"Transfer completed successfully"}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"string","example":{"message":"Bad Request - card not active or insufficient funds"}}}}}},"security":[{"bearerAuth":[]}]}},"/api/users/{id}":{"get":{"tags":["Users"],"summary":"Get user by ID","description":"Get user details by ID","operationId":"getUserById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}},"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CardDto"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"type":"string","example":{"message":"User with ID: 10 not found"}}}}}},"security":[{"bearerAuth":[]}]},"delete":{"tags":["Users"],"summary":"Delete user","description":"Delete user by ID","operationId":"deleteById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}},"204":{"description":"No Content","content":{"*/*":{"schema":{"type":"object"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"type":"string","example":{"message":"User with ID: 10 not found"}}}}}},"security":[{"bearerAuth":[]}]},"patch":{"tags":["Users"],"summary":"Update user","description":"Update user details","operationId":"updateUser","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdateDto"},"example":{"username":"<username>","password":"<password>","roles":["USER"]}}},"required":true},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDto"}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"type":"string","example":{"message":"User with ID: 10 not found"}}}}}},"security":[{"bearerAuth":[]}]}},"/api/cards/{id}/request-block":{"patch":{"tags":["Cards"],"summary":"Request to block card","description":"Request to block for own card","operationId":"requestBlock","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"string","example":{"message":"Block request submitted"}}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"type":"string","example":{"message":"Card with ID: 10 not found"}}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"type":"string","example":{"message":"Bad Request - card not active or user does not own the card"}}}}}},"security":[{"bearerAuth":[]}]}},"/api/cards/{id}/block":{"patch":{"tags":["Cards"],"summary":"Block card","description":"Block card by ID","operationId":"blockCard","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"string","example":{"id":10,"number":"**** **** **** 5013","holderName":"username","expirationDate":"2030-06-22","status":"BLOCKED","balance":42000.0}}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"type":"string","example":{"message":"Card with ID: 10 not found"}}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}}},"security":[{"bearerAuth":[]}]}},"/api/cards/{id}/activate":{"patch":{"tags":["Cards"],"summary":"Activate card","description":"Activate card by ID","operationId":"activateCard","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"404":{"description":"Not Found","content":{"application/json":{"schema":{"type":"string","example":{"message":"Card with ID: 10 not found"}}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}},"200":{"description":"OK","content":{"application/json":{"schema":{"type":"string","example":{"id":10,"number":"**** **** **** 5013","holderName":"username","expirationDate":"2030-06-22","status":"ACTIVE","balance":42000.0}}}}}},"security":[{"bearerAuth":[]}]}},"/api/cards":{"get":{"tags":["Cards"],"summary":"Get all cards","description":"List of all cards","operationId":"getAll","responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CardDto"}},"example":[{"id":1,"number":"**** **** **** 5013","holderName":"username","expirationDate":"2030-06-22","status":"BLOCKED","balance":42000.0},{"id":2,"number":"**** **** **** 3201","holderName":"username","expirationDate":"2030-06-23","status":"ACTIVE","balance":37000.0}]}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}}},"security":[{"bearerAuth":[]}]}},"/api/cards/{id}":{"get":{"tags":["Cards"],"summary":"Get card by ID","description":"Get card details by ID","operationId":"getById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"404":{"description":"Not Found","content":{"application/json":{"schema":{"type":"string","example":{"message":"Card with ID: 10 not found"}}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}},"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CardDto"}}}}},"security":[{"bearerAuth":[]}]},"delete":{"tags":["Cards"],"summary":"Delete card","description":"Delete card by ID","operationId":"deleteById_1","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"404":{"description":"Not Found","content":{"application/json":{"schema":{"type":"string","example":{"message":"Card with ID: 10 not found"}}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}},"204":{"description":"No Content","content":{"*/*":{"schema":{"type":"object"}}}}},"security":[{"bearerAuth":[]}]}},"/api/cards/my":{"get":{"tags":["Cards"],"summary":"Get own cards","description":"Get current user's cards","operationId":"getMyCards","parameters":[{"name":"status","in":"query","required":false,"schema":{"type":"string","enum":["ACTIVE","BLOCKED","EXPIRED"]}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","format":"int32","default":0}},{"name":"size","in":"query","required":false,"schema":{"type":"integer","format":"int32","default":3}}],"responses":{"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}},"200":{"description":"OK","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CardDto"}},"example":{"content":[{"id":2,"number":"**** **** **** 5013","holderName":"user","expirationDate":"2030-06-22","status":"BLOCKED","balance":42000.0},{"id":4,"number":"**** **** **** 3201","holderName":"user","expirationDate":"2030-06-23","status":"ACTIVE","balance":37000.0}],"pageable":{"pageNumber":0,"pageSize":2,"sort":{"empty":true,"sorted":false,"unsorted":true},"offset":0,"paged":true,"unpaged":false},"totalPages":3,"totalElements":6,"last":false,"size":2,"number":0,"sort":{"empty":true,"sorted":false,"unsorted":true},"numberOfElements":2,"first":true,"empty":false}}}}},"security":[{"bearerAuth":[]}]}},"/api/cards/balance":{"get":{"tags":["Cards"],"summary":"Get total balance","description":"Returns total balance of user's cards","operationId":"getBalance","responses":{"403":{"description":"Forbidden","content":{"application/json":{"schema":{"type":"string","example":{"message":"Access Denied"}}}}},"200":{"description":"OK","content":{"application/json":{"schema":{"type":"string","example":{"balance":"304000.00"}}}}}},"security":[{"bearerAuth":[]}]}}},"components":{"schemas":{"AuthRequest":{"type":"object","properties":{"username":{"type":"string","example":"admin"},"password":{"type":"string","example":"qwerty12345"}}},"CardDto":{"type":"object","properties":{"id":{"type":"integer","format":"int64","example":1},"number":{"type":"string","example":"**** **** **** 1234"},"holderName":{"type":"string","example":"username"},"expirationDate":{"type":"string","format":"date","example":"2025-06-23"},"status":{"type":"string","example":"ACTIVE","enum":["ACTIVE","BLOCKED","EXPIRED"]},"balance":{"type":"number","example":10500.51}}},"UserDto":{"required":["password","roles","username"],"type":"object","properties":{"id":{"type":"integer","format":"int64","example":1},"username":{"maxLength":2147483647,"minLength":4,"type":"string","example":"username"},"password":{"maxLength":2147483647,"minLength":4,"type":"string","example":"<encrypted_password>"},"roles":{"uniqueItems":true,"type":"array","example":["USER"],"items":{"type":"string","example":"[\"USER\"]"}},"cards":{"type":"array","example":[],"items":{"$ref":"#/components/schemas/CardDto"}}}},"TransferDto":{"required":["amount","fromCardId","toCardId"],"type":"object","properties":{"fromCardId":{"type":"integer","format":"int64","example":1},"toCardId":{"type":"integer","format":"int64","example":2},"amount":{"minimum":0.01,"exclusiveMinimum":false,"type":"number","example":900.0}}},"UserUpdateDto":{"type":"object","properties":{"username":{"maxLength":2147483647,"minLength":4,"type":"string"},"password":{"maxLength":2147483647,"minLength":8,"type":"string"},"roles":{"maxItems":2147483647,"minItems":1,"uniqueItems":true,"type":"array","items":{"type":"string"}}}}},"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}}}}